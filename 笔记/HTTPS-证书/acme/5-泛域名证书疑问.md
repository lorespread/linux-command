- [1 ç”Ÿæˆæ³›åŸŸåè¯ä¹¦](#1-ç”Ÿæˆæ³›åŸŸåè¯ä¹¦)
- [2 ä½¿ç”¨ acme.sh ç”Ÿæˆçš„  abc.com å’Œ \*.abc.com çš„è¯ä¹¦æ˜¯ä¸€æ ·çš„ä¹ˆ](#2-ä½¿ç”¨-acmesh-ç”Ÿæˆçš„--abccom-å’Œ-abccom-çš„è¯ä¹¦æ˜¯ä¸€æ ·çš„ä¹ˆ)
	- [ä¸»è¦åŒºåˆ«](#ä¸»è¦åŒºåˆ«)
	- [ç”Ÿæˆè¯ä¹¦çš„æ–¹å¼](#ç”Ÿæˆè¯ä¹¦çš„æ–¹å¼)
	- [å®‰è£…è¯ä¹¦çš„æ–¹å¼](#å®‰è£…è¯ä¹¦çš„æ–¹å¼)
	- [ç¤ºä¾‹ Nginx é…ç½®](#ç¤ºä¾‹-nginx-é…ç½®)
	- [ç”Ÿæˆå’Œå®‰è£…çš„è¯¦ç»†æ­¥éª¤](#ç”Ÿæˆå’Œå®‰è£…çš„è¯¦ç»†æ­¥éª¤)
	- [æ€»ç»“](#æ€»ç»“)

## 1 ç”Ÿæˆæ³›åŸŸåè¯ä¹¦

```python
acme.sh --issue --dns dns_ali -d ruiangeo.com -d '*.ruiangeo.com' --keylength ec-256
```

ğŸ”¥ï¼šè¿™è¡Œæ‰§è¡Œå‘½ä»¤ï¼Œç”Ÿæˆ ruiangeo.com åŠå…¶æ‰€æœ‰å­åŸŸåçš„ ECC è¯ä¹¦ï¼Œå³ä¸»åŸŸåå’Œå­åŸŸåå¯ä»¥å…¬ç”¨åŒä¸€ä¸ªè¯ä¹¦

## 2 ä½¿ç”¨ acme.sh ç”Ÿæˆçš„  abc.com å’Œ *.abc.com çš„è¯ä¹¦æ˜¯ä¸€æ ·çš„ä¹ˆ

ä½¿ç”¨ `acme.sh` ç”Ÿæˆçš„ `abc.com` å’Œ `*.abc.com` çš„è¯ä¹¦å¹¶ä¸å®Œå…¨ä¸€æ ·ã€‚å°½ç®¡å®ƒä»¬éƒ½å¯ä»¥ç”¨æ¥ä¿æŠ¤åŸŸåï¼Œä½†å®ƒä»¬çš„è¦†ç›–èŒƒå›´ä¸åŒã€‚

### ä¸»è¦åŒºåˆ«

1. **`abc.com`**: è¿™ä¸ªè¯ä¹¦åªè¦†ç›– `abc.com` è¿™ä¸ªå•ä¸€åŸŸåã€‚
2. **`*.abc.com`**: è¿™ä¸ªæ˜¯æ³›åŸŸåè¯ä¹¦ï¼Œå®ƒè¦†ç›– `abc.com` ä»¥åŠæ‰€æœ‰çš„å­åŸŸåï¼Œæ¯”å¦‚ `www.abc.com`ã€`blog.abc.com` ç­‰ã€‚

### ç”Ÿæˆè¯ä¹¦çš„æ–¹å¼

å½“ä½¿ç”¨ `acme.sh` ç”Ÿæˆè¿™äº›è¯ä¹¦æ—¶ï¼Œå¯ä»¥å•ç‹¬ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ç”Ÿæˆã€‚ä¾‹å¦‚ï¼š

```sh
acme.sh --issue --dns dns_ali -d abc.com -d '*.abc.com' --keylength ec-256
```

è¿™ä¸ªå‘½ä»¤ä¼šç”Ÿæˆä¸€ä¸ªè¯ä¹¦ï¼Œè¯¥è¯ä¹¦åŒæ—¶è¦†ç›– `abc.com` å’Œæ‰€æœ‰çš„å­åŸŸåã€‚

### å®‰è£…è¯ä¹¦çš„æ–¹å¼

å®‰è£…è¯ä¹¦çš„å‘½ä»¤æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¦†ç›–çš„åŸŸåä¸åŒã€‚ä¸‹é¢æ˜¯å¦‚ä½•å®‰è£…åŒ…å« `abc.com` å’Œ `*.abc.com` çš„æ³›åŸŸåè¯ä¹¦ï¼š

```sh
acme.sh --install-cert --ecc -d abc.com \
--key-file       /etc/nginx/ssl/abc.com.key  \
--fullchain-file /etc/nginx/ssl/abc.com.crt \
--ca-file        /etc/nginx/ssl/abc.com.ca.crt
```

### ç¤ºä¾‹ Nginx é…ç½®

ç¡®ä¿ä½ çš„ Nginx é…ç½®æ–‡ä»¶æŒ‡å‘æ­£ç¡®çš„è¯ä¹¦æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶ï¼š

```nginx
server {
    listen 443 ssl;
    server_name abc.com *.abc.com;

    ssl_certificate /etc/nginx/ssl/abc.com.crt;
    ssl_certificate_key /etc/nginx/ssl/abc.com.key;
    ssl_trusted_certificate /etc/nginx/ssl/abc.com.ca.crt;

    # å…¶ä»–é…ç½®...
}
```

### ç”Ÿæˆå’Œå®‰è£…çš„è¯¦ç»†æ­¥éª¤

1. **å®‰è£… `acme.sh`**:

    å¦‚æœè¿˜æ²¡æœ‰å®‰è£… `acme.sh`ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…å®ƒï¼š

    ```sh
    curl https://get.acme.sh | sh
    ```

2. **é…ç½® DNS API å‡­è¯**ï¼ˆä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼‰ï¼š

    ```sh
    export Ali_Key="ä½ çš„é˜¿é‡Œäº‘ API Key"
    export Ali_Secret="ä½ çš„é˜¿é‡Œäº‘ API Secret"
    ```

3. **ç”Ÿæˆè¯ä¹¦**ï¼š

    ä½¿ç”¨ `acme.sh` ç”ŸæˆåŒæ—¶è¦†ç›– `abc.com` å’Œ `*.abc.com` çš„è¯ä¹¦ï¼š

    ```sh
    acme.sh --issue --dns dns_ali -d abc.com -d '*.abc.com' --keylength ec-256
    ```

4. **å®‰è£…è¯ä¹¦**ï¼š

    å°†ç”Ÿæˆçš„è¯ä¹¦å®‰è£…åˆ°æŒ‡å®šä½ç½®ï¼š

    ```sh
    acme.sh --install-cert --ecc -d abc.com \
    --key-file       /etc/nginx/ssl/abc.com.key  \
    --fullchain-file /etc/nginx/ssl/abc.com.crt \
    --ca-file        /etc/nginx/ssl/abc.com.ca.crt
    ```

5. **æ›´æ–° Nginx é…ç½®**ï¼š

    ç¡®ä¿ä½ çš„ Nginx é…ç½®æ–‡ä»¶æŒ‡å‘æ­£ç¡®çš„è¯ä¹¦æ–‡ä»¶å’Œç§é’¥æ–‡ä»¶ï¼š

    ```nginx
    server {
        listen 443 ssl;
        server_name abc.com *.abc.com;

        ssl_certificate /etc/nginx/ssl/abc.com.crt;
        ssl_certificate_key /etc/nginx/ssl/abc.com.key;
        ssl_trusted_certificate /etc/nginx/ssl/abc.com.ca.crt;

        # å…¶ä»–é…ç½®...
    }
    ```

6. **é‡è½½ Nginx é…ç½®**ï¼š

    è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥é‡è½½ Nginx é…ç½®ï¼Œåº”ç”¨æ–°çš„è¯ä¹¦é…ç½®ï¼š

    ```sh
    sudo systemctl reload nginx
    ```

### æ€»ç»“

- **å•åŸŸåè¯ä¹¦ (`abc.com`)**: ä»…è¦†ç›– `abc.com`ã€‚
- **æ³›åŸŸåè¯ä¹¦ (`*.abc.com`)**: è¦†ç›– `abc.com` åŠå…¶æ‰€æœ‰å­åŸŸåã€‚
- å¯ä»¥åŒæ—¶ç”Ÿæˆå’Œå®‰è£…ä¸€ä¸ªè¯ä¹¦ï¼Œè¦†ç›– `abc.com` å’Œ `*.abc.com`ã€‚

é€šè¿‡è¿™äº›æ­¥éª¤ï¼Œä½ å¯ä»¥ç”Ÿæˆå¹¶å®‰è£…ä¸€ä¸ªåŒæ—¶è¦†ç›–ä¸»åŸŸåå’Œå…¶æ‰€æœ‰å­åŸŸåçš„è¯ä¹¦ï¼Œä»¥ç¡®ä¿æ‰€æœ‰åŸŸåå’Œå­åŸŸåçš„ HTTPS è¯·æ±‚éƒ½å¾—åˆ°ä¿æŠ¤ã€‚
