- [1 acme.sh 能否这是提前多少天重新生成么](#1-acmesh-能否这是提前多少天重新生成么)
	- [自定义续期提前时间](#自定义续期提前时间)
		- [设置自定义提前续期时间](#设置自定义提前续期时间)
	- [示例](#示例)
	- [说明](#说明)


## 1 acme.sh 能否这是提前多少天重新生成么

`acme.sh` 默认会在证书到期前的 30 天内自动续期证书。这个设定是为了确保在证书过期之前，有足够的时间完成续期过程，并更新相关配置。

### 自定义续期提前时间

`acme.sh` 提供了自定义证书续期提前时间的功能，你可以通过设置环境变量来修改这个默认值。具体来说，使用 `ACME_LE_RENEW_DAYS` 环境变量可以调整提前续期的天数。

#### 设置自定义提前续期时间

1. **设置环境变量**：
   在续期前提前 N 天执行续期，可以通过设置 `ACME_LE_RENEW_DAYS` 环境变量来实现。例如，如果你希望在证书到期前 15 天进行续期，可以设置：

   ```sh
   export ACME_LE_RENEW_DAYS=15
   ```

   这会使 `acme.sh` 在证书到期前 15 天进行续期。

2. **永久设置**：
   如果你希望永久应用这个设置，可以将环境变量添加到你的用户配置文件中，例如 `~/.bashrc` 或 `~/.bash_profile`。在文件末尾添加：

   ```sh
   export ACME_LE_RENEW_DAYS=15
   ```

   然后执行以下命令使更改生效：

   ```sh
   source ~/.bashrc
   ```

   或者

   ```sh
   source ~/.bash_profile
   ```

3. **重新加载证书**：
   修改环境变量后，`acme.sh` 会按照新的设置在定时任务中续期证书。可以通过以下命令验证是否生效：

   ```sh
   crontab -l
   ```

   确保 `acme.sh` 的 cron 任务运行时使用了新的续期设置。

### 示例

假设你希望将证书的提前续期时间设置为 10 天。你可以按照以下步骤操作：

1. **临时设置（仅对当前会话有效）**：

   ```sh
   export ACME_LE_RENEW_DAYS=10
   ```

2. **永久设置（对所有会话有效）**：

   - 打开 `~/.bashrc` 或 `~/.bash_profile` 文件：
   
     ```sh
     nano ~/.bashrc
     ```

   - 添加环境变量：
   
     ```sh
     export ACME_LE_RENEW_DAYS=10
     ```

   - 保存文件并重新加载：
   
     ```sh
     source ~/.bashrc
     ```

   - 验证是否生效：
   
     ```sh
     echo $ACME_LE_RENEW_DAYS
     ```

   - 确保 cron 任务中使用了新的设置。

### 说明

- **默认提前时间**：`acme.sh` 默认在证书到期前 30 天内自动续期。
- **自定义设置**：通过设置 `ACME_LE_RENEW_DAYS` 环境变量，可以自定义续期提前时间。
- **生效**：修改后，`acme.sh` 会在定时任务中使用新的提前时间来检查和续期证书。

这样，你可以根据需要调整证书的续期时间，确保续期操作在证书到期之前进行。
