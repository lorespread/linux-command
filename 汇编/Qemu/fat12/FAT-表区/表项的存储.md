# 1 表项的存储分布

在 FAT12 文件系统中，FAT 表的表项每个只占用 **12 比特**，并且在实际存储时并**没有对齐到字节边界**，而是紧凑排列的。因此，一个 FAT 表项实际上会跨字节存储，3 个字节存储 2 个表项。这种设计是为了节省存储空间。

---

### **FAT12 表项存储规则**
- 每个表项是 **12 比特**（1.5 字节）。
- FAT 表将多个表项紧密排列。
- **存储布局**：
  - 3 个字节存储 2 个表项：
    - 第一个表项占用低 12 比特（1.5 字节）。
    - 第二个表项占用高 12 比特（紧接第一个表项）。
  - 重复这个规则进行排列。

---

### **存储示例**
假设有两个表项：
- 第 1 个表项的值是 `0x123`。
- 第 2 个表项的值是 `0xABC`。

它们在 FAT 表中按如下方式存储：
1. 将表项按 **12 比特**表示：
   - 第 1 个表项：`0x123` → 二进制：`0001 0010 0011`。
   - 第 2 个表项：`0xABC` → 二进制：`1010 1011 1100`。

2. 将它们紧密排列到 3 个字节（24 比特）中：
   - 第一个表项低 8 比特存储在第一个字节。
   - 第一个表项的高 4 比特 + 第二个表项的低 4 比特，存储在第二个字节。
   - 第二个表项的高 8 比特存储在第三个字节。

3. 实际存储布局：
   ```
   字节 1:0010 0011 (0x23)
   字节 2:0011 1010 (0x3A)
   字节 3:1011 1100 (0xBC)
   ```

因此，存储在 FAT 表中的 3 个字节是：
```
0x23, 0x3A, 0xBC
```

---

### **表项访问方法**
由于表项没有对齐，每次访问需要计算表项的具体位置：
1. **计算表项的起始比特位置**：
   - 第 `N` 个表项从第 `N × 12` 比特开始。
2. **找到相关字节**：
   - 比如，起始比特落在第几个字节。
3. **提取比特位并解析**：
   - 可能需要合并两个相邻字节的数据。

#### 示例：
如果要读取第 `3` 个表项（从 `0` 开始计数）：
1. 起始比特位置：`3 × 12 = 36`。
2. 所属字节：`36 ÷ 8 = 4`（第 4 个字节，注意字节索引从 0 开始）。
3. 提取第 4 和第 5 个字节，拼接解析出 12 比特。

---

### **表项实际存储空间**
由于 FAT12 的紧凑存储方式：
- 每 2 个表项占用 3 字节。
- 1 个表项平均占用 1.5 字节（12 比特）。

---

### **总结**
- FAT12 的表项没有对齐，每个表项只占 12 比特。
- 表项存储紧凑，3 个字节存储 2 个表项。
- 读取或写入表项时，需要处理跨字节的情况，通过移位和掩码操作解析出对应的 12 比特数据。
